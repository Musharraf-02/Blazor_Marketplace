@page "/product/{id:int}"
@inject HttpClient Http
@using Marketplace.Shared
@using System.Net.Http.Json


<NavigationBar></NavigationBar>
<div class="container-fluid" style="background-color:white ;">
    <div class="row p-5" style="background-color: rgb(223, 236, 250);">
        <div class="col-12 text-center">
            <h3>Shop Single</h3>
            <span style="color: rgb(128, 128, 128);"><b>Home / Shop Single</b></span>
        </div>
    </div>
    <div style="background-color:white ;" class="row">
        <div class="col-12 m-auto">
            <div class="row">
                <div class="col-md-8 col-12 mx-auto">
                    <div class="row my-5">
                        <div class="col-md-6 col-12"
                             style="border: 1px solid rgb(223, 236, 250) ;border-radius: 10px;">
                            <img src="https://localhost:44371/api/UploadedFile?imageName=@product.image" class="img-fluid"
                                 style="height: auto;max-width: 100%;">
                        </div>
                        <div class="col-md-6 col-12">
                            <h2>@product.name</h2>
                            <br>
                            <h3>$@product.price</h3>

                            <br>

                            <div class="modal @ModalClass" id="exampleModalCenter" tabindex="-1" role="dialog"
                                 aria-labelledby="exampleModalCenterTitle" aria-hidden="true" style="display:@ModalDisplay">
                                <div class="modal-dialog modal-dialog-centered" role="document">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <h5 class="modal-title" id="exampleModalLongTitle">
                                                @product.name
                                            </h5>
                                            <button type="button" class="close" data-dismiss="modal" aria-label="Close" @onclick="()=>Close()">
                                                <span aria-hidden="true">&times;</span>
                                            </button>
                                        </div>
                                        <div class="modal-body">
                                            <span> Shop Name: @seller.shopName</span><br>
                                            <span> Shop Address: @sellerAddress.address</span><br>
                                            <span> Shop Phone: @seller.phoneNumber</span>
                                            <span> Email: @seller.emailAddress</span>


                                        </div>
                                        <div class="modal-footer">
                                            <button type="button" class="btn btn-primary" data-dismiss="modal" @onclick="()=>Close()">Close</button>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            @if (ShowBackdrop)
                            {
                                <div class="modal-backdrop fade show"></div>
                            }

                            <div class="btn-group">
                                <button class="btn btn-primary px-5 py-3 mx-2" @onclick="()=>Open()">
                                    View Details
                                </button>
                            </div>

                            <br>
                            <br>

                            <p style="color: rgb(128, 128, 128);">Category:&emsp;&emsp; @product.category</p>

                        </div>
                    </div>
                    <p class="text-center"><b><u style="color: #0069D9;">Description</u></b></p>
                    <div class="row my-5
                            ">
                        <div class="col-md-8 col-12 mx-auto">
                            <h6>Details</h6>
                            <p style="color: rgb(128, 128, 128);">
                                @product.description
                            </p>
                        </div>

                    </div>
                </div>
            </div>
            <hr>
            <div class="row">
                <div class="col-md-8 col-12 mx-auto my-4">
                    <div class="row  my-5">
                        <div class="col-md-4 col-12 mx-auto">
                            <img src="./images/logo.jpg">
                            <h5>Call us</h5>
                            <h5 style="color:#0069D9 ;">123 456 7890</h5>
                        </div>
                        <div class="col-md-4 col-12 mx-auto">
                            <br>
                            <span>329 Queensberry Sreet, North Melbourne VIC</span>
                            <br>
                            <span>351, Australia.</span>
                            <br>
                            <span>support@jobio.com</span>
                        </div>

                    </div>
                </div>
            </div>
            <hr>
            <div class="row">
                <div class="col-md-8  col-12 mx-auto my-3">
                    <span style="color: rgb(128, 128, 128);"><b>©2021 Superio, All Right Reserved.</b></span>
                </div>
            </div>

        </div>
    </div>
</div>

@code {

    [Parameter]
    public int id { get; set; }

    Product product = new Product();

    protected override async Task OnInitializedAsync()
    {
        product = await Http.GetFromJsonAsync<Product>("api/Product/GetByProductID?pId=" + id);
        seller = await Http.GetFromJsonAsync<Seller>("api/Seller/GetBySellerId?id=" + product.sellerId);
        sellerAddress = await Http.GetFromJsonAsync<Address>("api/Address?id=" + seller.addressId);
    }

    Seller seller = new Seller();
    Address sellerAddress = new Address();

    public string ModalDisplay = "none;";
    public string ModalClass = "";
    public bool ShowBackdrop = false;

    public void Open()
    {
        ModalDisplay = "block;";
        ModalClass = "Show";
        ShowBackdrop = true;
        StateHasChanged();
    }

    public void Close()
    {
        ModalDisplay = "none";
        ModalClass = "";
        ShowBackdrop = false;
        StateHasChanged();
    }


}
